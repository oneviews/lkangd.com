{"post":{"attributes":{"title":"ä¸ºä»€ä¹ˆ 'XX' ä¸æ˜¯ä¸€ä¸ª Hooks API?","date":"2019-01-26","spoiler":"æˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼Œä½†å¹¶ä¸æ˜¯æ„å‘³ç€æˆ‘ä»¬åº”è¯¥è¿™æ ·åšã€‚","link":"/post/why-isnt-x-a-hook-zh","min2read":"â˜•ï¸â˜•ï¸ 8 min read","wordcount":"2.2k"},"body":"<p>è‡ªä» <a href=\"https://reactjs.org/hooks\">React Hooks</a> å‘å¸ƒ alpha ç‰ˆæœ¬, å°±æœ‰å¾ˆå¤šäººå¯¹ä¸€äº›é—®é¢˜çš„è®¨è®ºï¼Œæ¯”å¦‚: â€œä¸ºä»€ä¹ˆæœ‰äº› API ä¸æ˜¯ä¸€ä¸ª Hook?â€ã€‚</p>\n<p>æ¯”å¦‚ä¸‹é¢è¿™äº›å°±æ˜¯ä¸€äº› Hooks APIï¼š</p>\n<ul>\n<li><a href=\"https://reactjs.org/docs/hooks-reference.html#usestate\"><code>useState()</code></a> å¯ä»¥ç”¨æ¥å£°æ˜ <code>state</code> å˜é‡ã€‚</li>\n<li><a href=\"https://reactjs.org/docs/hooks-reference.html#useeffect\"><code>useEffect()</code></a> å¯ä»¥ç”¨æ¥å£°æ˜ <code>side effects</code>ã€‚</li>\n<li><a href=\"https://reactjs.org/docs/hooks-reference.html#usecontext\"><code>useContext()</code></a> å¯ä»¥ç”¨æ¥è¯»å– <code>context</code>ã€‚</li>\n</ul>\n<p>ä½†æ˜¯æœ‰äº› API å°±ä¸æ˜¯ hooksï¼Œæ¯”å¦‚ <code>React.memo()</code> å’Œ <code>&lt;Context.Provider&gt;</code>ã€‚ä¸€èˆ¬å¤§å®¶æå‡ºæ¥çš„ Hook åŸºæœ¬ä¸Šæ˜¯*ä¸å¯ç»„åˆï¼ˆnoncompositionalï¼‰<em>å’Œ</em>åæ¨¡å—åŒ–ï¼ˆantimodularï¼‰*çš„ï¼Œè¿™ç¯‡æ–‡ç« ä¼šå¸®åŠ©ä½ ç†è§£ä¸ºä»€ä¹ˆã€‚</p>\n<p><strong>æ³¨ï¼šè¿™ç¯‡æ–‡ç« æ˜¯ä¸€ç¯‡æ·±å…¥æ¢è®¨çš„æ–‡ç« ï¼Œé˜…è¯»å¯¹è±¡åº”è¯¥æ˜¯å¯¹ API çš„è®¨è®ºæ˜¯éå¸¸æ„Ÿå…´è¶£çš„ï¼Œè€Œä¸æ˜¯ä¸ºäº†è€ƒè™‘ä½¿ç”¨ React æ¥æå‡æ•ˆç‡çš„ï¼</strong></p>\n<hr>\n<p>æˆ‘ä»¬æƒ³è®© React çš„ API ä¿æŒä»¥ä¸‹éå¸¸é‡è¦çš„ä¸¤ç‚¹:</p>\n<ol>\n<li>\n<p><strong>ç»„åˆ:</strong> å¯¹äº Hooks APIæ¥è¯´ï¼Œå¯ä»¥<a href=\"https://reactjs.org/docs/hooks-custom.html\">è‡ªå®šä¹‰ Hooks</a> æ˜¯è®©æˆ‘ä»¬æ„Ÿåˆ°éå¸¸å…´å¥‹çš„. æˆ‘ä»¬æœŸæœ›å¤§å®¶éƒ½å¯ä»¥æ¥æ„å»ºè‡ªå·±çš„Hooks API, å¹¶ä¸”æˆ‘ä»¬éœ€è¦ç¡®ä¿ä¸åŒäººå†™çš„ Hooks API <a href=\"/why-do-hooks-rely-on-call-order/#flaw-4-the-diamond-problem\">ä¸ä¼šé€ æˆå†²çª</a>ã€‚ (æˆ‘ä»¬æ˜¯ä¸æ˜¯å·²ç»è¢«è‡ªç”±çš„ç»„åˆç»„ä»¶è€Œä¸ç”¨æ‹…å¿ƒç›¸äº’é€ æˆå½±å“ç»™æƒ¯åäº†ï¼Ÿ)</p>\n</li>\n<li>\n<p><strong>è°ƒè¯•:</strong> æˆ‘ä»¬å¸Œæœ›éšç€åº”ç”¨è§„æ¨¡çš„ä¸æ–­å¢é•¿ <a href=\"/the-bug-o-notation/\">bug æ˜¯å¾ˆå®¹æ˜“å‘ç°çš„</a>çš„ã€‚Reactæœ€æ£’çš„ä¸€ä¸ªç‰¹æ€§å°±æ˜¯å¦‚æœæŸäº›å†…å®¹è¢«é”™è¯¯çš„æ¸²æŸ“äº†ï¼Œä½ å¯ä»¥è½»æ¾çš„æ‰¾åˆ°å¯¹åº”çš„ç»„ä»¶çš„ prop æˆ–è€… state å¯¼è‡´äº†è¿™ä¸ªé—®é¢˜ã€‚</p>\n</li>\n</ol>\n<p>ç»“åˆè¿™ä¸¤ç‚¹æ¥çœ‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥çŸ¥é“å“ªäº›æ˜¯<em>ä¸èƒ½</em>æˆä¸ºä¸€ä¸ª Hookã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸€äº›ä¾‹å­æ¥è¯´æ˜ï¼š</p>\n<hr>\n<h2>ä¸€ä¸ª Hook: <code>useState()</code></h2>\n<h3>ç»„åˆ</h3>\n<p>å¤šä¸ªè‡ªå®šä¹‰çš„ Hooks è°ƒç”¨ <code>useState()</code>ï¼Œè€Œä¸ä¼šé€ æˆå†²çªï¼š</p>\n<pre   class=\"language-js\"><code class=\"language-js\">function useMyCustomHook1() {\n  const [value, setValue] = useState(0);\n  // What happens here, stays here.\n}\n\nfunction useMyCustomHook2() {\n  const [value, setValue] = useState(0);\n  // What happens here, stays here.\n}\n\nfunction MyComponent() {\n  useMyCustomHook1();\n  useMyCustomHook2();\n  // ...\n}\n</code></pre><p>æ·»åŠ ä¸€ä¸ªä¸åœ¨æ¡ä»¶åˆ¤æ–­é‡Œçš„ <code>useState()</code> ï¼Œ è°ƒç”¨è¿™ä¸ª API æ˜¯å¾ˆå®‰å…¨çš„ã€‚ä½ ä¸éœ€è¦äº†è§£åœ¨ä¸€ä¸ªç»„ä»¶é‡Œé¢å£°æ˜äº†æ–°çš„ state å˜é‡è¢«å…¶ä»– Hooks ä½¿ç”¨äº†ã€‚ä¹Ÿä¸ä¼šå› ä¸ºæ›´æ–°äº†å…¶ä»–çŠ¶æ€å¯¼è‡´ state å˜é‡è¢«ç ´åã€‚</p>\n<p><strong>ç»“è®º:</strong> âœ… <code>useState()</code> ä¸ä¼šå¯¹å…¶ä»–è‡ªå®šä¹‰çš„ Hooks é€ æˆç ´åã€‚</p>\n<h3>è°ƒè¯•</h3>\n<p>Hooks æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œä½ å¯ä»¥åœ¨ Hooks <em>ä¹‹é—´</em>ä¼ é€’å€¼ï¼š</p>\n<pre data-line=\"4,12,14,\"  4,12,14=\"\" class=\"language-js\"><code 4,12,14=\"\" class=\"language-js\">function useWindowWidth() {\n  const [width, setWidth] = useState(window.innerWidth);\n  // ...\n  return width;\n}\n\nfunction useTheme(isMobile) {\n  // ...\n}\n\nfunction Comment() {\n  const width = useWindowWidth();\n  const isMobile = width &lt; MOBILE_VIEWPORT;\n  const theme = useTheme(isMobile);\n  return (\n    &lt;section className={theme.comment}&gt;\n      {/* ... */}\n    &lt;/section&gt;\n  );\n}\n</code></pre><p>ä½†æ˜¯å¦‚è¿‡æˆ‘ä»¬çš„ä»£ç å‡ºé”™äº†ï¼Œæˆ‘ä»¬æ€ä¹ˆè°ƒè¯•ï¼Ÿ</p>\n<p>å‡è®¾æˆ‘ä»¬ä» <code>theme.comment</code> é‡Œæ‹¿å‡ºæ¥çš„ä¸€ä¸ª css class æ˜¯é”™è¯¯çš„, é‚£æˆ‘ä»¬æ€ä¹ˆè°ƒè¯•è¿™ä¸ªé—®é¢˜ï¼Ÿæˆ‘ä»¬å¯ä»¥åœ¨ç»„ä»¶é‡Œè®¾ç½®ä¸€ä¸ªæ–­ç‚¹æˆ–è€…è¾“å‡ºä¸€äº›æ—¥å¿—ã€‚</p>\n<p>ä¹Ÿè®¸æˆ‘ä»¬å¯ä»¥å‘ç° <code>theme</code> æ˜¯é”™è¯¯çš„ï¼Œä½†æ˜¯ <code>width</code> å’Œ <code>isMobile</code>æ˜¯æ­£ç¡®çš„ã€‚è¿™å°±å‘Šè¯‰æˆ‘ä»¬é—®é¢˜æ˜¯å‘ç”Ÿåœ¨ <code>useTheme()</code> é‡Œé¢ã€‚ä¹Ÿæœ‰å¯èƒ½ <code>width</code> ä¸å¯¹ï¼Œé‚£ä¹ˆç›¸åº”çš„é—®é¢˜å°±å‡ºåœ¨ <code>useWindowWidth()</code> é‡Œã€‚</p>\n<p><strong>ä¸€çœ‹æœ€é¡¶éƒ¨çš„å¯¹åº” Hooks é‡Œçš„ä¸­é—´å€¼å°±çŸ¥é“é—®é¢˜å‘ç”Ÿåœ¨å“ªé‡Œäº†ã€‚</strong> æˆ‘ä»¬ä¸éœ€è¦æŸ¥çœ‹ç»„ä»¶é‡Œæ‰€æœ‰çš„ Hooks çš„å®ç°ã€‚</p>\n<p>æˆ‘ä»¬ç›´æ¥æŸ¥çœ‹æœ‰é—®é¢˜çš„é‚£ä¸ªå®ç°ï¼Œé‡å¤è¿™ä¸ªæ­¥éª¤å°±å¯ä»¥ç¡®å®šé—®é¢˜å…·ä½“é—®é¢˜å‘ç”Ÿåœ¨ä»€ä¹ˆåœ°æ–¹ã€‚</p>\n<p>å¦‚æœè‡ªå®šä¹‰ Hooks çš„åµŒå¥—å±‚çº§å¢åŠ äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªå°±å˜çš„æ›´åŠ é‡è¦ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æœ‰ä¸‰å±‚åµŒå¥—çš„è‡ªå®šä¹‰ Hookï¼Œæ¯å±‚ä½¿ç”¨äº†ä¸‰ä¸ªä¸åŒçš„è‡ªå®š Hooksã€‚ å®šä½<strong>3ä¸ªæœ‰é—®é¢˜çš„åœ°æ–¹</strong>å’Œå®šä½ <strong>3 + 3Ã—3 + 3Ã—3Ã—3 = 39ä¸ªæœ‰é—®é¢˜åœ°æ–¹</strong>ï¼ŒäºŒè€…ä¹‹é—´çš„æˆæœ¬<a href=\"/the-bug-o-notation/\">å·®åˆ«</a>æ˜¯éå¸¸å¤§çš„ã€‚å¹¸è¿çš„æ˜¯ï¼Œ<code>useState()</code> ä¸ä¼šå¯¹å…¶ä»– Hooks æˆ–è€…ç»„ä»¶é€ æˆè«åå…¶å¦™çš„å½±å“ã€‚é›è¿‡ç•™ç—•ï¼Œä¸€ä¸ª Hooks è¿”å›çš„é”™è¯¯å€¼ï¼Œå’Œæ™®é€šçš„å˜é‡æ˜¯æ²¡æœ‰ä»»ä½•åŒºåˆ«çš„ã€‚ğŸ›</p>\n<p><strong>ç»“è®º:</strong> âœ… <code>useState()</code> ä¸ä¼šéšè—æˆ‘ä»¬ä»£ç ä¸­çš„å› æœå…³ç³»ã€‚æˆ‘ä»¬å¯ä»¥ä¸€æ­¥æ­¥çš„å®šä½åˆ°å¯¹åº”çš„bugã€‚</p>\n<hr>\n<h2>ä¸æ˜¯ä¸€ä¸ª Hook: <code>useBailout()</code></h2>\n<p>ä½œä¸ºä¸€ç§ä¼˜åŒ–, ç»„ä»¶ä½¿ç”¨ Hooks å¯ä»¥é¿å…é‡æ–°æ¸²æŸ“ã€‚</p>\n<p>å¦ä¸€ç§æ–¹å¼æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a href=\"https://reactjs.org/blog/2018/10/23/react-v-16-6.html#reactmemo\"><code>React.memo()</code></a> åŒ…è£¹æ•´ä¸ªç»„ä»¶ã€‚ ä¸ºäº†é¿å…é‡æ–°æ¸²æŸ“ï¼Œ<code>React.memo()</code> ä¼šç”¨æœ¬æ¬¡å³å°†æ¸²æŸ“çš„ props å’Œæœ€åä¸€æ¬¡ç„¶çš„ props é€šè¿‡ <code>shallowly equal</code> å»åšæ¯”è¾ƒï¼Œ è¿™ä¸ªå’Œ <code>PureComponent</code> æ˜¯ç±»ä¼¼çš„ã€‚</p>\n<p><code>React.memo()</code> æ¥æ”¶ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°å¹¶è¿”å›ä¸€ä¸ªç»„ä»¶ï¼š</p>\n<pre data-line=\"4,\"  4=\"\" class=\"language-js\"><code 4=\"\" class=\"language-js\">function Button(props) {\n  // ...\n}\nexport default React.memo(Button);\n</code></pre><p><strong>ä½†æ˜¯ <code>useBailout()</code> ä¸ºä»€ä¹ˆä¸ä»…ä»…æ˜¯ä¸€ä¸ªé’©å­</strong></p>\n<p>ä¸è®ºä½ å°†å…¶ç§°ä¹‹ä¸º <code>useShouldComponentUpdate()</code>ï¼Œ <code>usePure()</code>ï¼Œ <code>useSkipRender()</code> æˆ–è€… <code>useBailout()</code>ï¼Œ è¿™ä¸ªææ¡ˆ(proposal)çœ‹èµ·æ¥å°±å’Œä¸‹é¢è¿™ä¸ªæ˜¯ä¸€æ ·çš„ï¼š</p>\n<pre   class=\"language-js\"><code class=\"language-js\">function Button({ color }) {\n  // âš ï¸ éçœŸå®API\n  useBailout(prevColor =&gt; prevColor !== color, color);\n\n  return (\n    &lt;button className={'button-' + color}&gt;  \n      OK\n    &lt;/button&gt;\n  )\n}\n</code></pre><p>ä¹Ÿæœ‰ä¸€äº›å…¶ä»–ä¸åŒçš„ææ¡ˆï¼ˆæ¯”å¦‚ï¼š<a href=\"https://github.com/reactjs/rfcs/pull/30#issuecomment-371337630\"><code>usePure()</code></a>ï¼‰ï¼Œä½†æ˜¯ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸ªææ¡ˆä¹Ÿæœ‰åŒæ ·çš„é—®é¢˜ã€‚</p>\n<h3>ç»„åˆ</h3>\n<p>è®©æˆ‘ä»¬å°è¯•å°† <code>useBailout()</code> åœ¨ä¸¤ä¸ªè‡ªå®šä¹‰çš„ Hooks ä¸­ä½¿ç”¨ï¼š</p>\n<pre data-line=\"4,5,19,20,\"  4,5,19,20=\"\" class=\"language-js\"><code 4,5,19,20=\"\" class=\"language-js\">function useFriendStatus(friendID) {\n  const [isOnline, setIsOnline] = useState(null);\n\n  // âš ï¸ éçœŸå®API\n  useBailout(prevIsOnline =&gt; prevIsOnline !== isOnline, isOnline);\n\n  useEffect(() =&gt; {\n    const handleStatusChange = status =&gt; setIsOnline(status.isOnline);\n    ChatAPI.subscribe(friendID, handleStatusChange);\n    return () =&gt; ChatAPI.unsubscribe(friendID, handleStatusChange);\n  });\n\n  return isOnline;\n}\n\nfunction useWindowWidth() {\n  const [width, setWidth] = useState(window.innerWidth);\n  \n  // âš ï¸ éçœŸå®API\n  useBailout(prevWidth =&gt; prevWidth !== width, width);\n\n  useEffect(() =&gt; {\n    const handleResize = () =&gt; setWidth(window.innerWidth);\n    window.addEventListener('resize', handleResize);\n    return () =&gt; window.removeEventListener('resize', handleResize);\n  });\n\n  return width;\n}\n</code></pre><p>å¦‚æœç°åœ¨åœ¨åŒä¸€ä¸ªç»„ä»¶ä¸­ä½¿ç”¨è¿™ä¸¤ä¸ªè‡ªå®šä¹‰çš„ Hooks ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>\n<pre data-line=\"2,3,\"  2,3=\"\" class=\"language-js\"><code 2,3=\"\" class=\"language-js\">function ChatThread({ friendID, isTyping }) {\n  const width = useWindowWidth();\n  const isOnline = useFriendStatus(friendID);\n  return (\n    &lt;ChatLayout width={width}&gt;\n      &lt;FriendStatus isOnline={isOnline} /&gt;\n      {isTyping &amp;&amp; 'Typing...'}\n    &lt;/ChatLayout&gt;\n  );\n}\n</code></pre><p>ä»€ä¹ˆæ—¶å€™é‡æ–°æ¸²æŸ“?</p>\n<p>å¦‚æœæ¯ä¸€ä¸ª <code>useBailout()</code> éƒ½æœ‰æƒé™å»è·³è¿‡æ›´æ–°ï¼Œé‚£ä¹ˆ <code>useWindowWidth()</code> é‡Œé¢çš„æ›´æ–°å°±ä¼šè¢« <code>useFriendStatus()</code> ç»™é˜»å¡ï¼Œåä¹‹äº¦ç„¶ã€‚ <strong>è¿™äº› Hooks ä¼šç›¸äº’å½±å“ã€‚</strong></p>\n<p>ç„¶è€Œï¼Œå¦‚æœå…è®¸<code>useBailout()</code> åœ¨ä¸€ä¸ªç»„ä»¶é‡Œå»é˜»æ­¢æ›´æ–°çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ <code>ChatThread</code> ç»„ä»¶é‡Œçš„ <code>isTyping</code> å±æ€§å‘ç”Ÿå˜åŒ–æ—¶ä¹Ÿæ— æ³•å»æ›´æ–°è¿™ä¸ªç»„ä»¶ã€‚</p>\n<p>æ›´ç³Ÿç³•çš„æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨è¿™ç§è¯­ä¹‰ï¼Œ<strong>ä»»ä½•æ–°æ·»åŠ åˆ° <code>ChatThread</code> é‡Œçš„ Hooks å¦‚æœæ²¡æœ‰<em>åŒæ ·</em>è°ƒç”¨ <code>useBailout()</code>ï¼Œé‚£ä¹ˆè¿™äº› Hooks ä¹ŸåŒæ ·ä¼šè¢«é˜»æ–­</strong>ã€‚ä¸ç„¶ <code>useBailout()</code> ä¹Ÿæ²¡æœ‰åŠæ³•åœ¨ <code>useWindowWidth()</code> å’Œ <code>useFriendStatus()</code> é˜»æ­¢æ›´æ–°æ—¶ â€œæŠ•ä¸Šåå¯¹ç¥¨ï¼ˆvote againstï¼‰â€ã€‚</p>\n<p><strong>ç»“è®º:</strong> ğŸ”´ <code>useBailout()</code> è¿åäº†ç»„åˆåŸåˆ™. æ·»åŠ  <code>useBailout()</code> åˆ°ä¸€ä¸ª Hook é‡Œé¢å°±ä¼šå½±å“å…¶ä»– Hooks çš„çŠ¶æ€æ›´æ–°ã€‚æˆ‘å¸Œæœ›å’Œ API æ˜¯<a href=\"/optimized-for-change/\">å¥å£®çš„(antifragile)</a>, ä½†æ˜¯ <code>useBailout()</code> çš„è¡Œä¸ºæ˜¯å®Œå®Œå…¨å…¨ç›¸åçš„ã€‚</p>\n<h3>è°ƒè¯•</h3>\n<p>åƒ <code>useBailout()</code> çš„è¿™æ ·çš„ hook ä¼šå¯¹è°ƒè¯•é€ æˆä»€ä¹ˆå½±å“ï¼Ÿ</p>\n<p>æˆ‘ä»¬ä½¿ç”¨åŒæ ·çš„åˆ—å­:</p>\n<pre   class=\"language-js\"><code class=\"language-js\">function ChatThread({ friendID, isTyping }) {\n  const width = useWindowWidth();\n  const isOnline = useFriendStatus(friendID);\n  return (\n    &lt;ChatLayout width={width}&gt;\n      &lt;FriendStatus isOnline={isOnline} /&gt;\n      {isTyping &amp;&amp; 'Typing...'}\n    &lt;/ChatLayout&gt;\n  );\n}\n</code></pre><p>å‡è®¾æœ‰äº›ä¸Šå±‚ç»„ä»¶çš„å±æ€§å‘ç”Ÿäº†å˜åŒ–ï¼Œä½†æ˜¯ <code>Typing...</code> label æ²¡æœ‰æŒ‰ç…§æˆ‘ä»¬é¢„æœŸæ˜¾ç¤ºå‡ºæ¥ã€‚è¿™æ—¶å€™æˆ‘ä»¬æ€ä¹ˆè°ƒè¯•å‘¢ï¼Ÿ</p>\n<p><strong>é€šå¸¸ï¼Œä½ ä¼šå¾ˆè‡ªä¿¡çš„å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦å»çœ‹<em>ä¸Šå±‚ç»„ä»¶</em>ã€‚</strong> å¦‚æœ <code>ChatThread</code> æ²¡æœ‰è·å¾— <code>isTyping</code> çš„æ–°å€¼ã€‚æˆ‘ä»¬å¯ä»¥æ‰“å¼€æ¸²æŸ“ <code>&lt;ChatThread isTyping={myVar} /&gt;</code> çš„ç»„ä»¶ï¼Œç„¶åå»æ£€æŸ¥ <code>myVar</code> ç­‰ç­‰ã€‚åœ¨åŒçº§ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½åœ¨ <code>shouldComponentUpdate()</code> ä¸­å‘ç°è¢«é˜»æ­¢äº†ï¼Œæˆ–è€… <code>isTyping</code> çš„å€¼æ²¡æœ‰æ­£ç¡®çš„ä¼ é€’è¿‡å»ã€‚æ£€æŸ¥åœ¨è¿™ä¸ªé“¾ä¸­çš„æ¯ä¸€ä¸ªç»„ä»¶é€šå¸¸ä¹Ÿèƒ½è½»æ¾çš„å®šä½åˆ°é—®é¢˜çš„æ ¹æºã€‚</p>\n<p>å¦‚æœ <code>useBailout()</code> Hook æ˜¯ä¸€ä¸ªçœŸå®çš„ APIã€‚åœ¨ä½ æ·±åº¦åœ°æ£€æŸ¥ <code>ChatThread</code> å’Œ <code>ChatThread</code> é‡Œæ‰€æœ‰ç»„ä»¶<em>ä¸­ä½¿ç”¨åˆ°çš„æ¯ä¸€ä¸ªè‡ªå®šä¹‰ Hook</em> ä¹‹å‰ï¼Œä½ æ°¸è¿œä¸çŸ¥é“è·³è¿‡æ›´æ–°çš„åŸå› ã€‚ç”±äºæ¯ä¸€ä¸ªçˆ¶ç»„ä»¶<em>åŒæ ·</em>å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰ Hooksï¼Œè¿™ä¸ª<a href=\"/the-bug-o-notation/\">æƒ…å†µï¼ˆscalesï¼‰</a>å°±å˜çš„æ›´åŠ å¤æ‚äº†ã€‚</p>\n<p>è¿™å°±åƒä½ åœ¨ä¸€ä¸ªæŠ½å±‰æŸœé‡Œæœ‰ä¸€å †å°æŠ½å±‰çš„å…¶ä¸­ä¸€ä¸ªæ‰¾åˆ°ä¸€æŠŠå°èºä¸åˆ€ä¸€æ ·ã€‚ä½ æ°¸è¿œä¸çŸ¥é“è¿™ä¸ªâ€œå‘â€åˆ°åº•æœ‰å¤šæ·±ã€‚</p>\n<p><strong>ç»“è®º:</strong> ğŸ”´ <code>useBailout()</code> Hook ä¸ä»…ä»…ç ´åå¯ç»„åˆæ€§, ä¸ºäº†æ‰¾åˆ°æœ‰ bug çš„é˜»æ­¢æ›´æ–°ä»£ç ï¼Œå¤§å¤§çš„å¢åŠ äº†è°ƒè¯•æ­¥éª¤å’Œè®¤çŸ¥è´Ÿè· â€”â€” åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™æ˜¯æŒ‡æ•°çº§åˆ«çš„ã€‚</p>\n<hr>\n<p>æˆ‘ä»¬è®¨è®ºäº†ä¸€ä¸ªçœŸæ­£å­˜åœ¨çš„ Hook - <code>useState()</code>ï¼Œå’Œå¦ä¸€ä¸ªçœ‹ä¸Šå»æ˜¯ Hookï¼Œä½†æ˜¯å®é™…ä¸Š<em>ä¸</em>æ˜¯ä¸€ä¸ª Hook - <code>useBailout()</code> çš„ä¾‹å­ï¼Œæˆ‘ä»¬æ¯”è¾ƒäº†ç»„åˆå’Œè°ƒè¯•ï¼Œå¹¶è®¨è®ºäº†ä¸ºä»€ä¹ˆå…¶ä¸­ä¸€ä¸ªæ˜¯æœ‰æ•ˆçš„ï¼Œå¦ä¸€ä¸ªäº‹æ— æ•ˆçš„ã€‚</p>\n<p>è™½ç„¶æ²¡æœ‰ â€œHook ç‰ˆæœ¬â€ çš„ <code>memo()</code> å’Œ <code>shouldComponentUpdate()</code>ï¼Œä½†æ˜¯Reactç¡®å®æä¾›äº†ä¸€ä¸ªå« <a href=\"https://reactjs.org/docs/hooks-reference.html#usememo\"><code>useMemo()</code></a> çš„ API. è™½ç„¶æœ‰ç›¸åŒçš„ç”¨é€”ï¼Œä½†æ˜¯ <code>useMemo()</code> æœ¬èº«çš„è¯­ä¹‰æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¸ä¼šé‡åˆ°ä¸Šé¢æ‰€è¯´çš„é—®é¢˜ã€‚</p>\n<p><code>useBailout()</code> åªæ˜¯ä¸€ä¸ªä¸ä¼šåƒ Hook ä¸€æ ·å·¥ä½œçš„ä¾‹å­ã€‚ä½†æ˜¯ä¹Ÿè¿˜æœ‰ä¸€äº›å…¶ä»–çš„ Hooks API â€”â€” æ¯”å¦‚ï¼Œ<code>useProvider()</code>, <code>useCatch()</code>, å’Œ <code>useSuspense()</code>ã€‚</p>\n<p>ç°åœ¨æ˜ç™½ä¸ºä»€ä¹ˆäº†å—?</p>\n<p><em>(ä½å¤´å˜€å’•: ç»„åˆ... è°ƒè¯•...)</em></p>\n","frontmatter":"title: ä¸ºä»€ä¹ˆ 'XX' ä¸æ˜¯ä¸€ä¸ª Hooks API?\ndate: '2019-01-26'\nspoiler: æˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼Œä½†å¹¶ä¸æ˜¯æ„å‘³ç€æˆ‘ä»¬åº”è¯¥è¿™æ ·åšã€‚","link":"/post/why-isnt-x-a-hook-zh","next":{"title":"Why Isnâ€™t X a Hook?","date":"2019-01-26","spoiler":"Just because we can, doesnâ€™t mean we should.","link":"/post/why-isnt-x-a-hook","min2read":"â˜•ï¸â˜•ï¸ 8 min read","wordcount":"1.4k"},"prev":{"title":"Why Do We Write super(props)?","date":"2018-11-30","spoiler":"Thereâ€™s a twist at the end.","link":"/post/why-do-we-write-super-props","min2read":"â˜•ï¸ 5 min read","wordcount":938}}}